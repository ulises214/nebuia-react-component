var D=Object.defineProperty,M=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var w=(e,t,s)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,x=(e,t)=>{for(var s in t||(t={}))N.call(t,s)&&w(e,s,t[s]);if(j)for(var s of j(t))T.call(t,s)&&w(e,s,t[s]);return e},p=(e,t)=>M(e,S(t));var I=(e,t)=>{var s={};for(var r in e)N.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&j)for(var r of j(e))t.indexOf(r)<0&&T.call(e,r)&&(s[r]=e[r]);return s};var A=(e,t,s)=>new Promise((r,o)=>{var n=c=>{try{u(s.next(c))}catch(d){o(d)}},l=c=>{try{u(s.throw(c))}catch(d){o(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,l);u((s=s.apply(e,t)).next())});import{r as i,j as a,c as h,B as L,P as g,u as C,a as v,s as B,b as U,d as E,e as k,A as G,f as O,L as Y,H as V,g as W}from"./index-ctX3Duu2.js";function Z(o,r){var n=o,{title:e,titleId:t}=n,s=I(n,["title","titleId"]);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const X=i.forwardRef(Z),P=X,H=({className:e})=>{const t=i.useMemo(()=>Math.floor(Math.random()*10)+1,[]);return a.jsx("div",{className:h("h-6 w-6 rounded-full bg-gradient-to-b",["from-[#6847a2] to-[#d4037d]","from-blue-500 via-blue-400 to-green-400","from-purple-500 via-purple-400 to-pink-400","from-red-500 via-yellow-500 to-yellow-300","from-cyan-500 via-teal-400 to-orange-500","from-pink-500 via-red-400 to-yellow-500","from-green-500 via-blue-400 to-purple-500","from-yellow-500 via-red-400 to-pink-500","from-teal-500 via-green-400 to-blue-500","from-purple-600 via-pink-400 to-red-500"].sort(()=>Math.random()-.5)[t-1],e)})},J=({title:e,isActive:t,icon:s,onClick:r,suffix:o,disabled:n,subTitle:l,className:u})=>a.jsxs(L,{variant:"outline",disabled:n,onClick:r,className:h("p-4 border border-solid flex items-center justify-start gap-4 w-full max-w-md",t&&"!border-nebuia-primary-500",u),children:[s,a.jsxs(g,{className:"flex grow flex-col justify-center gap-1 text-left",children:[a.jsx("span",{children:e}),l&&a.jsx("span",{className:"text-xs font-thin",children:l})]}),o&&a.jsx("div",{className:"size-8",children:o})]}),R=i.createContext({}),y=()=>i.useContext(R),q=()=>{const{docsListResult:e,createdDocuments:t,chooseTemplate:s}=y(),{t:r}=C();return a.jsxs("div",{className:"mt-8 flex flex-col items-center gap-4",children:[a.jsx(g,{className:"max-w-xs text-center font-bold",children:r("pages.signatureWelcome.shortDescription")}),e.result.map(o=>{var u,c,d;const n=t.find(m=>m.templateId===o.id),l=n&&!n.link;return a.jsx(J,{disabled:l,onClick:()=>{n||s(o.id),n&&window.open(n.link,"_blank")},isActive:!!n,title:o.name,icon:a.jsx(H,{}),suffix:n?a.jsx(P,{className:"text-nebuia-primary-500"}):void 0,subTitle:((c=(u=o.description)==null?void 0:u.length)!=null?c:0)>40?`${(d=o.description)==null?void 0:d.substring(0,40)}...`:o.description},o.id)})]})},z=()=>{const[e,t]=i.useState(),s=v();return i.useEffect(()=>{s.keys.then(r=>{r.status&&t(()=>{const o=new B.NebuiaSignDocuments(void 0);return o.init(r.payload),o})})},[]),e},K=e=>{const{onNextStep:t}=U(),[s,r]=i.useState({loading:!0,result:[]});return i.useEffect(()=>{if(!e)return;A(void 0,null,function*(){const n=yield e.getCompanyTemplates();if(!n.status){r({loading:!1,result:[],error:n.payload});return}if(!n.payload.length){yield t();return}r({loading:!1,result:n.payload})})},[t,e]),s},Q=({templateSdk:e,currentTemplate:t})=>{const s=v(),r=E(),[o,n]=i.useState({loading:!0,result:{documentId:"",link:""}}),l=i.useCallback(()=>A(void 0,null,function*(){var m;if(!e||!t)return;const c=yield r.existReport({report:s.getReport()});if(!c.status||!((m=c.payload.email)!=null&&m.verified)){n({loading:!1,result:{documentId:"",link:""},error:"Email not verified"});return}const d=yield e.createDocument({templateId:t,email:c.payload.email.email,kycId:c.payload.id});if(!d.status){n({loading:!1,result:{documentId:"",link:""},error:d.payload});return}return n({loading:!1,result:{documentId:d.payload.documentId,link:d.payload.signatureLink}}),{documentId:d.payload.documentId,link:d.payload.signatureLink,templateId:t}}),[t,s,r,e]);return i.useMemo(()=>[o,l],[l,o])},F=({sdk:e})=>{const t=v(),[s,r]=i.useState({loading:!0,result:[]});i.useEffect(()=>{e&&e.getReportDocuments({kycId:t.getReport()}).then(n=>{n.status&&r(l=>p(x({},l),{result:[...l.result,...n.payload]}))}).catch(n=>{console.error(n)}).finally(()=>{r(n=>p(x({},n),{loading:!1}))})},[t,e]);const o=i.useCallback(n=>{r(l=>p(x({},l),{result:[...l.result,n]}))},[]);return i.useMemo(()=>p(x({},s),{append:o}),[o,s])},_=({children:e})=>{const[t,s]=i.useState("welcome"),[r,o]=i.useState(),n=z(),l=F({sdk:n}),u=i.useCallback(f=>{s("list"),o(void 0),l.append(f)},[l]),c=K(n),d=Q({templateSdk:n,currentTemplate:r}),m=i.useMemo(()=>({step:t,chooseTemplate:f=>{o(f),s("details")},currentTemplate:r,docCreateResult:d[0],docsListResult:p(x({},c),{loading:c.loading||l.loading}),goToList:()=>{s("list"),o(void 0)},createdDocuments:l.result,useTemplate:()=>A(void 0,null,function*(){const[,f]=d,b=yield f();b&&(window.open(b.link,"_blank"),u(b))})}),[d,l.loading,l.result,t,r,c,u]);return a.jsx(R.Provider,{value:m,children:e})},$="data:image/png;base64,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",ee=({signs:e})=>{const{t}=C(),{dark:s}=O().theme;return a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"px-4 sm:px-0",children:a.jsx(g,{className:"max-w-xs text-center",children:t("signature.title")})}),a.jsx("div",{className:"mt-6 border-t border-gray-100",children:a.jsx("dl",{className:"divide-y divide-gray-100",children:[...e].sort((r,o)=>r.localeCompare(o)).map(r=>a.jsxs("div",{className:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[a.jsx("dt",{className:h("text-sm font-bold leading-6",{"text-gray-900":!s,"text-gray-400":s}),children:t(`signature.types.${r}.title`)}),a.jsx("dd",{className:h("mt-1 text-sm leading-6 sm:col-span-2 sm:mt-0",{"text-gray-700":!s,"text-gray-200":s}),children:t(`signature.types.${r}.description`)})]},r))})})]})},te=()=>{const{t:e}=C(),{goToList:t,currentTemplate:s,docsListResult:r,useTemplate:o,docCreateResult:n}=y();k({action:t,label:e("pages.genericWelcome.startButton"),side:"previous"});const l=i.useMemo(()=>n.error?e("common.retry"):e("common.continue"),[n.error,e]);if(k({action:o,label:l,side:"next"}),!s)return null;const u=r.result.find(c=>c.id===s);return u?a.jsxs("div",{className:"flex w-full max-w-sm flex-col items-center gap-4",children:[a.jsx("picture",{children:a.jsx("img",{src:$,alt:""})}),a.jsx(g,{className:"text-center text-lg font-bold",children:u.name}),u.description&&a.jsx(g,{className:"text-center",children:u.description}),a.jsx(ee,{signs:u.signsTypes}),n.error&&a.jsx(G,{variant:"error",title:e("signature.createResult.error.title"),message:e("signature.createResult.error.message")})]}):null},se=()=>{const{t:e}=C(),{docsListResult:t,goToList:s}=y();return k({action:s,label:e("pages.genericWelcome.startButton"),side:"next"}),t.loading?a.jsx("div",{className:"flex flex-col justify-center",children:a.jsx(Y,{})}):t.error?a.jsx("div",{children:t.error}):a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("figure",{children:a.jsx("img",{src:V,alt:"",className:"w-full max-w-[27rem]"})}),a.jsx(W,{children:e("pages.signatureWelcome.title")}),a.jsx(g,{className:"text-center",children:e("pages.signatureWelcome.shortDescription")})]})},re=()=>{const{step:e}=y();return e==="list"?a.jsx(q,{}):e==="details"?a.jsx(te,{}):a.jsx(se,{})};function oe(){return a.jsx(_,{children:a.jsx(re,{})})}export{oe as default};
