var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var L=(e,t,s)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,g=(e,t)=>{for(var s in t||(t={}))Z.call(t,s)&&L(e,s,t[s]);if(N)for(var s of N(t))H.call(t,s)&&L(e,s,t[s]);return e},I=(e,t)=>K(e,Q(t));var v=(e,t)=>{var s={};for(var r in e)Z.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&N)for(var r of N(e))t.indexOf(r)<0&&H.call(e,r)&&(s[r]=e[r]);return s};var R=(e,t,s)=>new Promise((r,o)=>{var i=u=>{try{c(s.next(u))}catch(l){o(l)}},d=u=>{try{c(s.throw(u))}catch(l){o(l)}},c=u=>u.done?r(u.value):Promise.resolve(u.value).then(i,d);c((s=s.apply(e,t)).next())});import{r as a,j as n,h as W,f as V,c as j,u as D,P as w,A as P,B as F,i as X,e as O,H as U,L as M,a as ee,g as te}from"./index-ctX3Duu2.js";function se(o,r){var i=o,{title:e,titleId:t}=i,s=v(i,["title","titleId"]);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ne=a.forwardRef(se),re=ne;function ae(o,r){var i=o,{title:e,titleId:t}=i,s=v(i,["title","titleId"]);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const oe=a.forwardRef(ae),ie=oe,T=a.createContext({}),q=a.createContext({}),z=a.createContext({}),y=()=>a.useContext(T),_=()=>a.useContext(q),$=()=>a.useContext(z),ce=({children:e})=>{const[t,s]=a.useState(),r=a.useMemo(()=>({company:t,setCompany:s}),[t]);return n.jsx(q.Provider,{value:r,children:e})},le=({children:e})=>{const[t,s]=a.useState({files:[],nss:""}),r=a.useCallback(i=>{s(d=>g(g({},d),i))},[]),o=a.useMemo(()=>({data:t,setData:r}),[t,r]);return n.jsx(z.Provider,{value:o,children:e})},ue=({children:e})=>{const[t,s]=a.useState("welcome"),{setCurrentView:r}=W(),o=a.useCallback(()=>{let c;t==="welcome"&&(c="nss"),t==="nss"&&(c="documents"),t==="documents"&&(c="finish"),t==="finish"&&r("details"),c&&s(c)},[r,t]),i=a.useCallback(()=>{let c;t==="nss"&&(c="welcome"),t==="documents"&&(c="nss"),c&&s(c)},[t]),d=a.useMemo(()=>({step:t,onNextStep:o,onPreviousStep:i}),[o,i,t]);return n.jsx(T.Provider,{value:d,children:e})},G=a.forwardRef((r,s)=>{var o=r,{label:e}=o,t=v(o,["label"]);const{theme:{dark:i}}=V();return n.jsxs("label",{className:j("font-thin block mb-2 text-xs",{"text-666":i,"text-gray-900":!i}),htmlFor:t.id,children:[e,n.jsx("input",I(g({},t),{className:j("block w-full text-sm border  rounded-md cursor-pointer focus:outline-none  ",{"text-gray-900 border-gray-300 bg-gray-50":!i,"text-gray-400 bg-gray-700 border-gray-600 placeholder:text-gray-400":i}),id:t.id,type:"file",ref:s}))]})});G.displayName="InlineInputFile";const A=({children:e})=>{const{company:t}=_(),{step:s}=y(),{t:r}=D();return t?n.jsxs("div",{className:"p-6 space-y-6 rounded-md shadow-md",children:[n.jsx(w,{className:"text-center font-bold text-lg",children:r(`services.credit.${s}.title`)}),n.jsx(w,{children:r(`services.credit.${s}.message`)}),e]}):n.jsx(n.Fragment,{})},de=()=>{const{onNextStep:e}=y(),[t,s]=a.useState(!0),{company:r}=_(),[o,i]=a.useState({}),{setData:d}=$(),[c,u]=a.useState(),l=r==null?void 0:r.credit.collaborator_document_config,f=a.useCallback(()=>l?l.every(p=>o[p.document_name])?(u(void 0),!0):(u("Todos los documentos son requeridos"),!1):!1,[l,o]);a.useEffect(()=>{f()},[o,f]);const S=m=>{s(!1),m.preventDefault(),f()&&(d({files:Object.entries(o).map(([x,h])=>{if(l!=null&&l.find(C=>C.document_name===x))return{name:x,file:h}}).filter(Boolean)}),e())};if(!l)return null;const E=m=>p=>{var h;const x=(h=p.target.files)==null?void 0:h[0];if(!x){i(b=>(delete b[m],b));return}i(I(g({},o),{[m]:x}))};return n.jsxs(A,{children:[c&&n.jsx(P,{variant:t?"info":"error",message:c}),n.jsxs("form",{onSubmit:S,className:"space-y-2",children:[l.map(m=>{const p=!!o[m.document_name];return n.jsxs("div",{className:j("flex gap-2 items-center px-2 py-1 rounded-lg",{"bg-nebuia-primary-500/10":p}),children:[m.document_type==="PDF"?n.jsx(re,{className:"size-4"}):n.jsx(ie,{className:"size-4"}),n.jsx(G,{label:m.document_name,accept:m.document_type==="Image"?"image/png,image/jpeg":"application/pdf",onChange:E(m.document_name),onAbort:()=>{i(x=>(delete x[m.document_name],x))}})]},m.document_name)}),n.jsx("div",{className:"w-full flex justify-end",children:n.jsx(F,{variant:"primary",type:"submit",className:"!py-1.5",children:"Enviar"})})]})]})},me=()=>{const[e,t]=a.useState({loading:!0}),{setCurrentView:s}=W(),r=$(),{t:o}=D(),i=X(),d=a.useCallback(()=>R(void 0,null,function*(){t({loading:!0});const l={nss:r.data.nss,files:r.data.files},f=yield i.creditsEnrollmentUploadDocuments(l);if(!f.status){t({error:f.payload});return}t({success:!0})}),[r.data.files,r.data.nss,i]);a.useEffect(()=>{d()},[d]);const c=a.useCallback(()=>{s("details")},[s]);O({side:"next",action:c,label:o("common.continue"),active:"success"in e});const u=(()=>{const l=f=>({title:o(`services.credit.finish.${f}.title`),message:o(`services.credit.finish.${f}.message`)});return"success"in e?l("success"):"error"in e?l("error"):l("loading")})();return n.jsxs(A,{children:[("loading"in e||"success"in e)&&n.jsxs("div",{className:"space-y-1",children:[n.jsx(w,{className:"font-bold text-lg",children:u.title}),n.jsx(w,{className:"text-sm",children:u.message})]}),"error"in e&&n.jsx(P,{variant:"error",title:u.title,message:[u.message,e.error]}),"success"in e&&n.jsx("div",{className:"flex justify-center items-center",children:n.jsx("img",{src:U,alt:"",className:"w-full max-w-[18rem]"})}),"loading"in e&&n.jsx(M,{}),"error"in e&&n.jsx("div",{className:"flex justify-center",children:n.jsx(F,{variant:"primary",onClick:()=>void d(),children:o("common.retry")})})]})};function fe(o,r){var i=o,{title:e,titleId:t}=i,s=v(i,["title","titleId"]);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{fillRule:"evenodd",d:"M3.28 2.22a.75.75 0 0 0-1.06 1.06l14.5 14.5a.75.75 0 1 0 1.06-1.06l-1.745-1.745a10.029 10.029 0 0 0 3.3-4.38 1.651 1.651 0 0 0 0-1.185A10.004 10.004 0 0 0 9.999 3a9.956 9.956 0 0 0-4.744 1.194L3.28 2.22ZM7.752 6.69l1.092 1.092a2.5 2.5 0 0 1 3.374 3.373l1.091 1.092a4 4 0 0 0-5.557-5.557Z",clipRule:"evenodd"}),a.createElement("path",{d:"m10.748 13.93 2.523 2.523a9.987 9.987 0 0 1-3.27.547c-4.258 0-7.894-2.66-9.337-6.41a1.651 1.651 0 0 1 0-1.186A10.007 10.007 0 0 1 2.839 6.02L6.07 9.252a4 4 0 0 0 4.678 4.678Z"}))}const xe=a.forwardRef(fe),pe=xe;function he(o,r){var i=o,{title:e,titleId:t}=i,s=v(i,["title","titleId"]);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"}),a.createElement("path",{fillRule:"evenodd",d:"M.664 10.59a1.651 1.651 0 0 1 0-1.186A10.004 10.004 0 0 1 10 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0 1 10 17c-4.257 0-7.893-2.66-9.336-6.41ZM14 10a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z",clipRule:"evenodd"}))}const ve=a.forwardRef(he),je=ve,be=({setType:e,type:t})=>n.jsxs("div",{className:"nebuia-icon-wrapper",children:[t==="password"&&n.jsx(je,{className:"nebuia-icon",onClick:()=>e("text")}),t==="text"&&n.jsx(pe,{className:"nebuia-icon",onClick:()=>e("password")})]}),ge=({type:e,id:t,label:s,onChange:r,placeholder:o,value:i,required:d,errorMessage:c,onChangeEvent:u,className:l,readonly:f,autoComplete:S,extraSmall:E,onFocus:m,subLabel:p,button:x})=>{const[h,b]=a.useState(e),{theme:{text:C,dark:k,secondaryBackground:Y}}=V();return n.jsxs("div",{className:j(l,E&&"nebuia-input-wrapper-extra-small"),children:[n.jsx("label",{id:`${t}-label`,style:{color:C},htmlFor:t,className:"nebuia-label",children:s}),p&&n.jsx("p",{className:"nebuia-sub-label",children:p}),n.jsxs("div",{className:"nebuia-input-wrapper",children:[n.jsxs("div",{className:"flex w-full items-end justify-center gap-1",children:[n.jsx("input",{value:i,onChange:B=>{r==null||r(B.target.value),u==null||u(B)},id:t,name:t,disabled:f,placeholder:o,type:h,required:d,onFocus:m,autoComplete:S?t:"off",style:{color:C,backgroundColor:k?Y:"white"},className:j("nebuia-input-disabled",k?"input-dark":"input-light","nebuia-input",c&&"nebuia-input-error",c&&k&&"nebuia-input-error-dark")}),x&&n.jsx("div",{className:"nebuia-button-wrapper",children:x})]}),e==="password"&&n.jsx(be,{type:h,setType:b})]}),!f&&n.jsx("p",{className:j("nebuia-error-message",!c&&"nebuia-error-message-invisible",!c&&"select-none"),children:c!=null?c:"texto"})]})};function we(e){let t=0,s=!1,r;for(let o=e.length-1;o>=0;o--)r=parseInt(e.charAt(o),10),s&&(r*=2)>9&&(r-=9),s=!s,t+=r;return t%10===0}function ye(e){var c,u,l;const t=/^(\d{2})(\d{2})(\d{2})\d{5}$/,s=e.toString().match(t);if(!s)return!1;const r=parseInt((c=s[1])!=null?c:"",10),o=new Date().getFullYear()%100;let i=parseInt((u=s[2])!=null?u:"",10),d=parseInt((l=s[3])!=null?l:"",10);return r!==97&&(i<=o&&(i+=100),d<=o&&(d+=100),d>i)?!1:we(e)}function Ce(e){return typeof e!="string"?!1:ye(e)}const Ne=()=>{const[e,t]=a.useState(""),{onNextStep:s}=y(),{setData:r}=$(),[o,i]=a.useState(),d=l=>Ce(l)?(i(void 0),!0):(i("El NSS no es vÃ¡lido"),!1),c=l=>{d(l),t(l)},u=l=>{l.preventDefault(),d(e)&&(r({nss:e}),s())};return n.jsx(A,{children:n.jsx("form",{onSubmit:u,children:n.jsx(ge,{autoComplete:!0,id:"nss",label:"Nss",type:"text",value:e,onChange:c,errorMessage:o,required:!0,button:n.jsx(F,{variant:"primary",type:"submit",className:"!py-1.5",disabled:!!o,children:"Enviar"})})})})},Se=()=>{const e=ee(),{onNextStep:t}=y(),{setCompany:s}=_(),{t:r}=D(),[o,i]=a.useState({loading:!0});return a.useEffect(()=>{"success"in o&&s(o.success)},[s,o]),a.useEffect(()=>{d();function d(){return R(this,null,function*(){const c=yield e.getCompanySettings();c.status?i({success:c.payload}):i({error:c.payload})})}},[e]),O({action:t,label:r("pages.genericWelcome.startButton"),side:"next",active:"success"in o}),"loading"in o?n.jsx(M,{}):"error"in o?n.jsx(P,{variant:"error",message:o.error}):n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("figure",{children:n.jsx("img",{src:U,alt:"",className:"w-full max-w-[27rem]"})}),n.jsx(te,{children:r("services.credit.instructions.title")}),n.jsx(w,{className:"text-center",children:r("services.credit.instructions.message")})]})};function Re(){return n.jsx(ue,{children:n.jsx(ce,{children:n.jsx(le,{children:n.jsx(Ee,{})})})})}function Ee(){const{step:e}=y();return e==="welcome"?n.jsx(Se,{}):e==="nss"?n.jsx(Ne,{}):e==="documents"?n.jsx(de,{}):n.jsx(me,{})}export{Re as default};
